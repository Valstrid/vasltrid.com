---
interface Props {
  lang?: 'en' | 'ar';
}

const { lang = 'en' } = Astro.props;
const isArabic = lang === 'ar';

const t = {
  en: {
    home: 'Home',
    services: 'Services',
    why: 'Why us',
    process: 'Process',
    cta: 'Get in touch',
    langLabel: 'EN',
    english: 'English',
    arabic: 'العربية'
  },
  ar: {
    home: 'الرئيسية',
    services: 'خدماتنا',
    why: 'لماذا نحن',
    process: 'منهجيتنا',
    cta: 'تواصل معنا',
    langLabel: 'AR',
    english: 'English',
    arabic: 'العربية'
  }
}[lang];
---

<nav class="nav" id="nav">
  <div class="container nav-inner">
    <a href={isArabic ? '/ar#home' : '#home'} class="nav-logo">
      <svg viewBox="0 0 28 28" fill="none" xmlns="http://www.w3.org/2000/svg">
        <rect width="28" height="28" rx="6" fill="#fff"/>
        <path d="M8 19L14 9L20 19" stroke="#050505" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"/>
      </svg>
      {isArabic ? 'فالستريد' : 'Valstrid'}
    </a>

    <div class="nav-links" id="navLinks">
      <a href="#home" class="nav-link">{t.home}</a>
      <a href="#services" class="nav-link">{t.services}</a>
      <a href="#why" class="nav-link">{t.why}</a>
      <a href="#process" class="nav-link">{t.process}</a>
      <div class="lang-dropdown">
        <button class="lang-toggle" aria-label="Select language">
          <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round">
            <circle cx="12" cy="12" r="10"/>
            <line x1="2" y1="12" x2="22" y2="12"/>
            <path d="M12 2a15.3 15.3 0 0 1 4 10 15.3 15.3 0 0 1-4 10 15.3 15.3 0 0 1-4-10 15.3 15.3 0 0 1 4-10z"/>
          </svg>
          {t.langLabel}
          <svg class="lang-chevron" width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <polyline points="6 9 12 15 18 9"/>
          </svg>
        </button>
        <div class="lang-menu">
          <a href="/" class:list={['lang-option', { active: !isArabic }]}>{t.english}</a>
          <a href="/ar" class:list={['lang-option', { active: isArabic }]}>{t.arabic}</a>
        </div>
      </div>
      <a href="mailto:hi@hisonrisa.com" class="nav-cta">{t.cta}</a>
    </div>

    <button class="nav-toggle" id="navToggle" aria-label="Toggle navigation">
      <span></span><span></span><span></span>
    </button>
  </div>
</nav>

<script>
  const nav = document.getElementById('nav');
  if (nav) {
    window.addEventListener('scroll', () => {
      nav.classList.toggle('scrolled', window.scrollY > 40);
    }, { passive: true });
  }

  const navToggle = document.getElementById('navToggle');
  const navLinks = document.getElementById('navLinks');

  if (navToggle && navLinks) {
    navToggle.addEventListener('click', () => navLinks.classList.toggle('open'));
    navLinks.querySelectorAll('a').forEach(link => {
      link.addEventListener('click', () => navLinks.classList.remove('open'));
    });
  }

  document.querySelectorAll('a[href^="#"]').forEach(anchor => {
    anchor.addEventListener('click', function(e) {
      e.preventDefault();
      const target = document.querySelector(this.getAttribute('href') || '');
      if (target) target.scrollIntoView({ behavior: 'smooth', block: 'start' });
    });
  });
</script>
